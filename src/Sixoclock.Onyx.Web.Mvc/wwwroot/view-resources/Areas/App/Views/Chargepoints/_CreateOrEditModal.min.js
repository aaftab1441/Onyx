(function(n){app.modals.CreateOrEditChargepointModal=function(){var t,u=abp.services.app.chargepoint,r=abp.services.app.chargePointModel,f=abp.services.app.oCPPFeature,i=null;this.init=function(n){t=n;i=t.getModal().find("form");i.validate();_$featuresInformationsForm=t.getModal().find("form[name=FeaturesInformationsForm]")};this.save=function(){var r,f,n,e;if(i.valid()){for(r=_$featuresInformationsForm.serializeArray(),f=[],n=0;n<r.length;n++)f.push({OCPPFeatureId:parseInt(r[n].value.split("_")[0]),FeatureName:r[n].value.split("_")[1],ChargepointId:0,TenantId:0});e=i.serializeFormToObject();e.ChargepointFeature=f;t.setBusy(!0);u.createOrUpdateChargepoint(e).done(function(){t.close();location.reload()}).always(function(){t.setBusy(!1)})}};n("#MountTypeId").change(function(){r.getChargepointModelsByMountList({id:n("#MountTypeId").val()}).done(function(t){var i='<option value="0">'+app.localize("DropdownDefault")+"<\/option>";n.each(t.chargepointModels,function(){i+="<option value='"+this.id+"'>"+this.name+"<\/option>"});n("#ChargepointModelId").html(i)})});n("#ChargepointModelId").change(function(){r.getChargepointModelForChargepoint({id:n("#ChargepointModelId").val()}).done(function(t){t!=null?(n("#lblModel").text("Vendor : "+t.vendor+""),n("#lblConnectors").text("Connectors : "+t.noOfConnectors+""),n("#Connectors").val(t.noOfConnectors),n("#OCPPVersionId").val(t.ocppVersionId),n("#OCPPTransportId").val(t.ocppTransportId),n("#lblCapacity").text("Capacity : "+t.capacity+"")):(n("#lblModel").text("Vendor : "),n("#lblConnectors").text("Connectors : "),n("#Connectors").val(),n("#OCPPVersionId").val(),n("#OCPPTransportId").val(),n("#lblCapacity").text("Capacity : "))})});n("#OCPPVersionId").change(function(){f.getOCPPFeaturesByOCPPVersionList({id:n("#OCPPVersionId").val()}).done(function(t){var i="";t.ocppFeatures.length>0?n("#OCPPFeaturesForm").css("display","block"):n("#OCPPFeaturesForm").css("display","none");n.each(t.ocppFeatures,function(){i+="<tr><td><label class='control-label col-sm-12 pull-left'><input name='ChargepointFeatureId' value='"+this.id+" _"+this.name+"' type='checkbox' ) /> "+this.name+"<\/label><\/td><\/tr>"});n("#OCPPFeatures").html(i)})})}})(jQuery);