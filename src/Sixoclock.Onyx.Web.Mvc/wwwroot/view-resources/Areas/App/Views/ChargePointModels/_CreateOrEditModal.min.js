(function(n){app.modals.CreateOrEditChargepointModelModal=function(){var t,r=abp.services.app.chargePointModel,u=abp.services.app.oCPPFeature,i=null;this.init=function(n){t=n;i=t.getModal().find("form");i.validate();_$releaseInformationsForm=t.getModal().find("form[name=ReleaseInformationsForm]");_$communicationInformationsForm=t.getModal().find("form[name=CommunicationInformationsForm]");_$electricalInformationsForm=t.getModal().find("form[name=ElectricalInformationsForm]");_$otherInformationsForm=t.getModal().find("form[name=OtherInformationsForm]");_$featuresInformationsForm=t.getModal().find("form[name=FeaturesInformationsForm]")};this.save=function(){var u,f,n,e;if(i.valid()){for(u=_$featuresInformationsForm.serializeArray(),f=[],n=0;n<u.length;n++)f.push({OCPPFeatureId:parseInt(u[n].value.split("_")[0]),FeatureName:u[n].value.split("_")[1],ChargepointModelId:0,TenantId:0});e=i.serializeFormToObject();e.ModelFeatures=f;t.setBusy(!0);r.createOrUpdateChargepointModel(e).done(function(n){for(var f,e,o,s,h,c,u,l=_$releaseInformationsForm.serializeArray(),a=[],i=0;i<l.length;i++)a.push({ChargeReleaseOptionId:l[i].value,ChargepointModelId:n});for(f=_$electricalInformationsForm.serializeArray(),e=[],i=0;i<f.length;i++)e.push({ElectricalOptionId:f[i].value,ChargepointModelId:n});for(o=_$communicationInformationsForm.serializeArray(),s=[],i=0;i<o.length;i++)s.push({ComOptionId:o[i].value,ChargepointModelId:n});for(h=_$otherInformationsForm.serializeArray(),c=[],i=0;i<h.length;i++)c.push({OtherOptionId:h[i].value,ChargepointModelId:n});u={};u.releaseOptionModels=a;u.electricalOptionModels=e;u.comOptionModels=s;u.otherOptionModels=c;r.createOrUpdateChargepointModelOptions(u).done(function(){t.close();location.reload()}).always(function(){t.setBusy(!1)})}).always(function(){t.setBusy(!1)})}};n("#OCPPVersionId").change(function(){u.getOCPPFeaturesByOCPPVersionList({id:n("#OCPPVersionId").val()}).done(function(t){var i="";t.ocppFeatures.length>0?n("#OCPPFeaturesForm").css("display","block"):n("#OCPPFeaturesForm").css("display","none");n.each(t.ocppFeatures,function(){i+="<tr><td><label class='control-label col-sm-12 pull-left'><input name='ModelFeatureId' value='"+this.id+" _"+this.name+"' type='checkbox' ) /> "+this.name+"<\/label><\/td><\/tr>"});n("#OCPPFeatures").html(i)})})}})(jQuery);