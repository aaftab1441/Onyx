(function () { app.modals.CreateOrEditRuleModal = function () { var t, u = abp.services.app.servicePriceParameter, r = null; this.init = function (n) { t = n; r = t.getModal().find("form[name=PriceParametersForm]");r.validate({ignore:""})};var f=$("#EntityName"),i=$("#PropertyName"),n=$("#Value").val();f.on("change",function(){t.setBusy(!0);u.getProperties(f.find(":selected").text()).done(function(n){i.find("option").remove().end();$.each(n,function(n,t){i.append($("<option>",{value:t.displayText,text:t.displayText,type:t.type}))});i.trigger("change")}).always(function(){t.setBusy(!1)})});i.on("change",function(){var t=i.find(":selected").attr("type");t==="Int32"||t==="Float"||t==="Double"||t==="String"||t==="Single"?($("#Value").replaceWith('<input class="form-control" type="text" name="Value" id="Value" value="'+n+'" required>'),n=""):t==="DateTime"?($("#Value").replaceWith('<input id="Value" name="Value" class="form-control form-control-inline input-medium date-picker"  type="text" value="'+n+'">'),$("#Value").daterangepicker({timePicker:!1,singleDatePicker:!0}),n=""):t==="TimeSpan"?($("#Value").replaceWith('<input id="Value" name="Value" class="form-control timepicker timepicker-default"  type="text" value="'+n+'">'),$("#Value").daterangepicker({timePicker:!0,singleDatePicker:!0}),n=""):u.getPropertyValues(t).done(function(t){$("#Value").replaceWith('<select id="Value" name="Value" class="form-control" <\/select>');$.each(t,function(t,i){$("#Value").append($("<option>",{value:i.displayText,text:i.displayText,type:i.type,selected:i.displayText===n}))});n=""}).always(function(){})});i.trigger("change");this.save=function(){if(r.valid()){var n=r.serializeFormToObject();t.setBusy(!0);u.createOrUpdateRule({Rule:n}).done(function(){abp.notify.info(app.localize("SavedSuccessfully"));t.close();abp.event.trigger("app.createOrEditRuleModalSaved")}).always(function(){t.setBusy(!1)})}}}})();