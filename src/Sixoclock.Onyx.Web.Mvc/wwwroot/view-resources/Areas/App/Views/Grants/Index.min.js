(function(){$(function(){function o(n){abp.message.confirm(app.localize("GrantDeleteWarningMessage",n.WhatEver),function(r){r&&i.deleteRuleSet({id:n.id}).done(function(){t();abp.notify.success(app.localize("SuccessfullyDeleted"))})})}function t(){e.ajax.reload()}var n=$("#GrantsTable"),i=abp.services.app.ruleSetService,r={create:abp.auth.hasPermission("Pages.Grants.Create"),edit:abp.auth.hasPermission("Pages.Grants.Edit"),"delete":abp.auth.hasPermission("Pages.Grants.Delete")},u=new app.ModalManager({viewUrl:abp.appPath+"App/Grants/CreateOrEditModal",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/Grants/_CreateOrEditModal.js",modalClass:"CreateOrEditRuleSetModal"}),f=new app.ModalManager({viewUrl:abp.appPath+"App/GrantRules",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/GrantRules/Index.js",modalClass:"EditRulesModel"}),e=n.DataTable({paging:!0,serverSide:!0,processing:!0,ajax:function(t,r){i.getRuleSets().done(function(t){n.data=t.ruleSets;r(n)})},columnDefs:[{targets:0,data:null,orderable:!1,autoWidth:!1,defaultContent:"",rowAction:{cssClass:"btn btn-xs btn-primary blue",text:'<i class="fa fa-cog"><\/i> '+app.localize("Actions")+' <span class="caret"><\/span>',items:[{text:app.localize("Edit"),visible:function(){return r.edit},action:function(n){u.open({id:n.record.id})}},{text:app.localize("EditRules"),action:function(n){f.open({id:n.record.id})}},{text:app.localize("Delete"),visible:function(n){return!n.record.isStatic&&r.delete},action:function(n){o(n.record)}}]}},{targets:1,data:"name"},{targets:2,data:"translation"},{targets:3,data:"ruleCount"}]});$("#CreateNewGrantButton").click(function(){u.open()});$("#RefreshGrantsButton").click(function(n){n.preventDefault();t()});abp.event.on("app.createOrEditRuleSetModalSaved",function(){t()})})})();