(function(){app.modals.EditRulesModel=function(){function o(n){abp.message.confirm(app.localize("GrantDeleteWarningMessage",n.WhatEver),function(t){t&&r.deleteRule({id:n.id}).done(function(){i();abp.notify.success(app.localize("SuccessfullyDeleted"))})})}function i(){e.ajax.reload()}this.init=function(n){_modalManager=n;_$form=_modalManager.getModal().find("form");_$form.validate()};var n=$("#RulesTable"),r=abp.services.app.ruleService,u={create:abp.auth.hasPermission("Pages.Grants.Create"),edit:abp.auth.hasPermission("Pages.Grants.Edit"),"delete":abp.auth.hasPermission("Pages.Grants.Delete")},f=new app.ModalManager({viewUrl:abp.appPath+"App/GrantRules/CreateOrEditModal",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/GrantRules/_CreateOrEditModal.js",modalClass:"CreateOrEditRuleModal"}),t=$("#RuleSetId").val(),e=n.DataTable({paging:!0,serverSide:!0,processing:!0,ajax:function(i,u){r.getRules(t).done(function(t){n.data=t.rules;u(n)})},columnDefs:[{targets:0,data:null,orderable:!1,autoWidth:!0,defaultContent:"",rowAction:{cssClass:"btn btn-xs btn-primary blue",text:'<i class="fa fa-cog"><\/i> '+app.localize("Actions")+' <span class="caret"><\/span>',items:[{text:app.localize("Edit"),visible:function(){return u.edit},action:function(n){f.open({id:n.record.id,ruleSetId:t})}},{text:app.localize("Delete"),visible:function(n){return!n.record.isStatic&&u.delete},action:function(n){o(n.record)}}]}},{targets:1,data:"relationStart"},{targets:2,data:"entityName"},{targets:3,data:"propertyName"},{targets:4,data:"ruleCondition"},{targets:5,data:"value"},{targets:6,data:"relationEnd"}]});$("#CreateNewRuleButton").click(function(){f.open({id:0,ruleSetId:t})});$("#RefreshRulesButton").click(function(n){n.preventDefault();i()});abp.event.on("app.createOrEditRuleModalSaved",function(){i()})}})();